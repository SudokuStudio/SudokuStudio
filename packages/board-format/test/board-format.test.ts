import { binary, fPuzzles } from "../dist/board-format";
import { writeFile } from "fs/promises";

describe('binary', () => {
    test('clipped', async () => {
        // // "Clipped" by glum_hippo: Arrow, Thermo, Givens, King
        // const fPuzzlesB64 = 'N4IgzglgXgpiBcBOANCALhNAbO8QGEsIAHYmAExFQEMBXNACwHsAnBEABQYiNIAIAQlloBbGH2oBranwDmwkQH1upJlRAtaOMDDTsAyrXJNJtPgFo+MAG4wWATz4smAd2R8AxkwUA7d9R9yPgBmAA9gvgAjJlC+EVowNE8mHzRqCB8JLCw+RnFyCFlMMD4AM2cRPgBGc0QAOj59JjE+AqK0EuoWcWosbupyRyLbHzqAHR8JgEFUiHMAaQzZCysAR1pe1sLiuOpHHyYktCZaDwYt6lkU3qx7ccmfABUGOxFm3TsVtp34xL5ElgQDzYRwZDz9HRlCpRLSRXJMXIke7TFjOFwrPKeCAsDw4ILfJJeHyJTD0GAlTFgUR8JilXIvLbtTpYFLLTFdNH3dSyQGUeAAbX5wAAvsgRWLReKpZKZRKALrIIWy6US1UqkUKpVq5Ugay9Wi4ABsqGGMB8CDQmhgyptmvVNu12rtOr1wlwAFYTRARharS79bgql6ffBLQb/W6EAAWYNm33hp2K+2O5MapMOqW6gMIYKx82hv0pmXOoul6Ul1MZ4sKkABDCSJbxmCoPIsN5iNB2BBCkBEHzk7v8kAAJUN+Hd6mHAHZ8FHJwAOfDBBf4ABMIDlcslvYyA4FQ+H7rXk6jS8nwVnk9Xl83277e8FI9PE9Qw4vhqv+Cnn/nG63Yp3fswEHEcj1/V8x2/V8Zw/V9Fw/W8aw5Vxu1Ae9gP3UDL1fU9l1fC911fa9103VAPBgbIMIPI853/NDdyo6j8FgkdIMnGdwJHRdf1IkByMo7ssIQu8GJA4dFxfEcZznCCz1kkia34rAqK48cNxEoCxOvSS32Yk8v30njFIo5TBOHbT1IA9CxJnPDVJkkdEDU3ilJU6czy3LcgA=';

        // // Unique classic 1
        // const fPuzzlesB64 = 'N4IgzglgXgpiBcBOANCALhNAbO8QCUIAHInMEVAQwFc0ALAewCcEQAFOiLYgAgDkYAdwC2lAHYUQTamRhpWfZqKw8w1ACYMA1tR7SyPSiSwBPAHQ8AgmPU96lNAHIwPTAEJJAcyYR1CANr+oABulFjUuCggnhDBMBLwaNIwAL7IwGkZ6ZmZIKHhuAAcqDFxCUkRufkRCADsJbHxCBWp6XlhNfAAbA1lzck5ALrIQTnZbdW4AIy9TYkDEx2Rs+ULWetDIxuLBQgATCv9lePbpynDozudAMyH88dnJ2MZF+vtu0h3Lc8/J++dM2ijVWD3+uB6QL691SrzBCGKkLm3yeKLekwQAFYvms4Z9ESDWi8trj6vijoTfmilggIaUkTj0fAEXSCVVqfAsWToZsgrjOSzyZS2R9mcDBVdllzkSF2bSxdyJXVsQ9zlshYqOcqKajcQAWLXnQYpIA===';


        // // "Bird in a Storm" by Gustaf Hafvenstein: Palindrome, Kropki w/negative constraint, King, Nonconsecutive
        // const fPuzzlesB64 = 'N4IgzglgXgpiBcBOANCALhNAbO8QCEIAnAEwAIIA7MgQzLDQHsiBbEVGgVzQAtmEQAcU4MaAMzIAJcQDcYlBjCrsQRTjjAw0AgMpoalEjVL1OJRgGtOZNRtoAHe1gCeAOjIAdSl70GjJiyJGewsIG3UYMAcnNzIAQTIAIywaAGMLMnM0ej4Adyi6IhoMRjJGCQBGeAAmJK1cmHkyNFzS1JgsLDB3BNyeTBhMxmzE+sbqFraOrrIWGAMo3hhnWiJB1MYFGFTuCDkezqG0ArWyAHM9+VcvLzjKDABaC0oIM55s20jol3cAOVKSK9MGRUgZ6I0KMcOhIqLQQTxIlFnq93oBMAiiLEY+xulAAKgjMkVctQsFRBhACmR7DRSYYgnNkLRDLMRB95uQlvQaHMyLkaCsxPSksMeGR5CRuiozkQICQEABteXAAC+yBVatV6q1mp1GoAusglbrtRrTSaVQajWbjTbrZbzbaHfrDU7XTb7Y7PXaXV63c6rX63R7rSGgwaQAYMMi3tp4Gg1DBUJRNhstjsMHIEPHOImQNTaSR6bglSBaZEFfKQAAlRAAYQAbCoa7WAKxNgActYALE2AOzdvutpv1htNlu13vDidj0eoKtd6dzheNucAZkX1fXK+r1Vnm6Hc93bcPA7XtdXTfXPaX55nF7nI/v1f7T6r/eqU4qID1euV4cBYhiDAayUO0CqgO0nRgAq1YVBuVZwY2v5qiAkFdDBVa7l+J4fshEHTNB8CVphtaIE2u7tt+mqoQRGHrq+V5UShaGEcR67YfuuHUSxGELq+C5ccxtFEdWfFNguPZ4TRUEYeOk5zuOlFSTxIlVuO25qdOynCcR47XtW45ttpMmqeOHGaYJ+EmcRI7mSOlnSehqkjvJ1Yjkh3E6c+8H9kpnnWd55nvkxVlOcRdaUXOdaTsZYXeR+D61g5KnEZ2r51hesWsfu/G3llGFwa+u6Zf5cVVoxJ6SaV2Xzqe+5VUJAWafptUNaFNWdi1dZtY5HUHtWdZGdVsn9VWI5DY1ZVwceO5Dvlzl7ppHmTTV/Yae5IW9RhdYaZ2y3tSNrljVpw2qRRTZwX5K0Yb5U5XQdql1mRc6dmR802aRg5vadxFwc9s3fddqmFRdA6/uGlAwGcxSXDBRQlN+qDwxAjAKr+QA===';

        // // "159" by zetamath (Renban, Kropki no negative constraint)
        // const fPuzzlesB64 = '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=';

        const fPuzzlesB64 = 'N4IgzglgXgpiBcBOANCALhNAbO8QDEB7AJzWJjDAAIBlAVwBNCBrOkVAQzrQAsSEQABR4QsEAA7iqAISx0AtjGRUOzDlQDmc+QH0RkwuxDE6OMDDQCAMjABmaQgDcYxKreKF5VACI0AslQATAAMgQCMAHQAOgB2sQDi5ACeVADGMFhY1KmEMWgcEDFUDBAamNRYHMQaLlS8HEUNKSS8hBq5HJkpHAwAVhzpeVQA7iJoMGkZWBFGGsQQDAgA2kugjp10uGGoZc4xCGSbAL7IwCdnp+dXlzdnALrIq9cXL88g63K4AOw7EHsHJhgzyODyep3eG1wAGZfv94IcgbdgUjwR9NggUCBdjB9vDASDHq9bhDPggACywnEA44oon3QnIukk9HwACslNxCMZBNWzNwFKxfypeJpdO5qMhCAAbBzqYj6WCxbTgaCmWjcDLBXCucT1Qh2VrhTqlQqTeK1pL4AAOWUi+Ugh4geQcAAeEHkCmWoHSmQEACUpQBhQIgc4gH1Yf2s4Oh8ERqOBqGx71Tf1kxPJ8OpvB+9NkzPxnPR1kF7MgAOBqWl305oNfauRouB+thwvl6NWhtpwOd1tlv2BZtdnODqt9mvlwcl8eNyeB/Mz/2DpOLnNWjOr8vrhdx/vr6e7id+9djw+z49DkFHIA';

        const fPuzzlesDecodedBoard = fPuzzles.parseFpuzzles(fPuzzlesB64);

        const ourBin = binary.writeBuffer(fPuzzlesDecodedBoard);
        await writeFile('./test/board.bin', ourBin);

        const ourB64 = await binary.writeLzmaBase64(fPuzzlesDecodedBoard);
        console.log(ourB64);
        console.log(fPuzzlesB64.length, ourB64.length);

        const ourBoard = await binary.readLzmaBase64(ourB64);

        await writeFile('./test/board.json', JSON.stringify(ourBoard, null, 2));
        const ourB642 = await binary.writeLzmaBase64(ourBoard);

        expect(ourB64).toEqual(ourB642);

        const ourBoard2 = await binary.readLzmaBase64(ourB64);
        expect(ourBoard).toEqual(ourBoard2);
    });
});
